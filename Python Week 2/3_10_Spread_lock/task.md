У вас есть распределенное приложение работающее на десятках серверах. Вам необходимо написать декоратор `single` который гарантирует, что декорируемая функция не исполняется параллельно.

Пример использования:

```python
import time


@single(max_processing_time=datetime.timedelta(minutes=2))
def process_transaction():
    time.sleep(2)
```

Параметр `max_processing_time` указывает на максимально допустимое время работы декорируемой функции.